$directoryPath = "C:\Program Files (x86)\Zoom"

if (Test-Path -Path $directoryPath -PathType Container) {
    # Directory exists, execute code here
    Write-Output "Directory exists!"
    $downloadUrl = "https://zoom.us/client/latest/ZoomInstaller.exe"
$destinationFolder = "C:\Program Files (x86)\Zoom"
$destinationPath = "$destinationFolder\ZoomInstaller.exe"

# Create the destination folder if it doesn't exist
if (-not (Test-Path -Path $destinationFolder)) {
    New-Item -ItemType Directory -Path $destinationFolder | Out-Null
}

# Download the file
Invoke-WebRequest -Uri $downloadUrl -OutFile $destinationPath

# Verify if the download was successful
if (Test-Path -Path $destinationPath) {
    Write-Host "ZoomInstaller.exe downloaded successfully to $destinationPath."

 
 $zoomInstallerPath = "C:\Program Files (x86)\Zoom\ZoomInstaller.exe"

# Start the Zoom installer process with silent and hidden options
$installerProcess = Start-Process -FilePath $zoomInstallerPath -ArgumentList "/silent" -WindowStyle Hidden -PassThru

# Wait for the installer process to complete
$installerProcess.WaitForExit()

# Check if Zoom is installed by looking for the Zoom executable
if (Test-Path -Path "C:\Users\$env:USERNAME\AppData\Roaming\Zoom\bin\Zoom.exe") {
    Write-Host "Zoom installed successfully."
} else {
    Write-Host "Failed to install Zoom."
}
}

}
else {

    # Directory doesn't exist, skip this part and move on
    Write-Output "Directory does not exist, skipping!"
    # for next part of code
    $directoryPath = "C:\Program Files (x86)\Teams"

if (Test-Path -Path $directoryPath -PathType Container) {
    # Directory exists, execute code here
    Write-Output "Directory exists!"
    # Your code goes here
$downloadUrl = "https://go.microsoft.com/fwlink/?linkid=2187327&clcid=0xc09&culture=en-au&country=au"
$destinationFolder = "C:\Program Files (x86)\Teams"
$destinationPath = "$destinationFolder\TeamsInstaller.exe"

# Create the destination folder if it doesn't exist
if (-not (Test-Path -Path $destinationFolder)) {
    New-Item -ItemType Directory -Path $destinationFolder | Out-Null
}

# Download the file
Invoke-WebRequest -Uri $downloadUrl -OutFile $destinationPath

# Verify if the download was successful
if (Test-Path -Path $destinationPath) {
    Write-Host "TeamsInstaller.exe downloaded successfully to $destinationPath."

    $teamsInstallerPath = "C:\Program Files (x86)\Teams\TeamsInstaller.exe"

    # Start the Teams installer process with silent and hidden options
    $installerProcess = Start-Process -FilePath $teamsInstallerPath -ArgumentList "--silent" -WindowStyle Hidden -PassThru

    # Wait for the installer process to complete
    $installerProcess.WaitForExit()

    # Check if Teams is installed by looking for the Teams executable
    if (Test-Path -Path "C:\Users\$env:USERNAME\AppData\Local\Microsoft\Teams\current\Teams.exe") {
        Write-Host "Teams installed successfully."
    } else {
        Write-Host "Failed to install Teams."
    }
} else {
    Write-Host "Failed to download TeamsInstaller.exe."
}
}
else {
    # Directory doesn't exist, skip this part and move on
    Write-Output "Directory does not exist, skipping!"
    # Other code to be executed
    Return
}

   
}














$directoryPath1 = "C:\Program Files (x86)\Teams"
$directoryPath2 = "C:\Program Files (x86)\Zoom"

if (Test-Path -Path $directoryPath1 -PathType Container) {
    # If this directory exists execute the code below
    Write-Output "Directory 1 exists!"
    # Code Below
    $downloadUrl = "https://zoom.us/client/latest/ZoomInstaller.exe"
$destinationFolder = "C:\Program Files (x86)\Zoom"
$destinationPath = "$destinationFolder\ZoomInstaller.exe"

# Create the destination folder if it doesn't exist
if (-not (Test-Path -Path $destinationFolder)) {
    New-Item -ItemType Directory -Path $destinationFolder | Out-Null
}

# Download the file
Invoke-WebRequest -Uri $downloadUrl -OutFile $destinationPath

# Verify if the download was successful
if (Test-Path -Path $destinationPath) {
    Write-Host "ZoomInstaller.exe downloaded successfully to $destinationPath."

 
 $zoomInstallerPath = "C:\Program Files (x86)\Zoom\ZoomInstaller.exe"

# Start the Zoom installer process with silent and hidden options
$installerProcess = Start-Process -FilePath $zoomInstallerPath -ArgumentList "/silent" -WindowStyle Hidden -PassThru

# Wait for the installer process to complete
$installerProcess.WaitForExit()

# Check if Zoom is installed by looking for the Zoom executable
if (Test-Path -Path "C:\Users\$env:USERNAME\AppData\Roaming\Zoom\bin\Zoom.exe") {
    Write-Host "Zoom installed successfully."
} else {
    Write-Host "Failed to install Zoom."
}

 
}

}

if (Test-Path -Path $directoryPath2 -PathType Container) {
    # If this directory exists execute the code below
    Write-Output "Directory 2 exists!"
    # code below
    $downloadUrl = "https://go.microsoft.com/fwlink/?linkid=2187327&clcid=0xc09&culture=en-au&country=au"
$destinationFolder = "C:\Program Files (x86)\Teams"
$destinationPath = "$destinationFolder\TeamsInstaller.exe"

# Create the destination folder if it doesn't exist
if (-not (Test-Path -Path $destinationFolder)) {
    New-Item -ItemType Directory -Path $destinationFolder | Out-Null
}

# Download the file
Invoke-WebRequest -Uri $downloadUrl -OutFile $destinationPath

# Verify if the download was successful
if (Test-Path -Path $destinationPath) {
    Write-Host "TeamsInstaller.exe downloaded successfully to $destinationPath."

    $teamsInstallerPath = "C:\Program Files (x86)\Teams\TeamsInstaller.exe"

    # Start the Teams installer process with silent and hidden options
    $installerProcess = Start-Process -FilePath $teamsInstallerPath -ArgumentList "--silent" -WindowStyle Hidden -PassThru

    # Wait for the installer process to complete
    $installerProcess.WaitForExit()

    # Check if Teams is installed by looking for the Teams executable
    if (Test-Path -Path "C:\Users\$env:USERNAME\AppData\Local\Microsoft\Teams\current\Teams.exe") {
        Write-Host "Teams installed successfully."
    } else {
        Write-Host "Failed to install Teams."
    }
} else {
    Write-Host "Failed to download TeamsInstaller.exe."
}

}
